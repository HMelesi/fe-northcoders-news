(this["webpackJsonpnorthcoders-news"]=this["webpackJsonpnorthcoders-news"]||[]).push([[0],{25:function(e,t,a){e.exports=a(55)},30:function(e,t,a){},31:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),l=a.n(c),s=(a(30),a(1)),o=a(2),i=a(4),m=a(3),u=(a(31),a(5)),p=function(e){var t=e.status,a=e.msg;return r.a.createElement("div",{className:"content__container"},r.a.createElement("h2",{className:"content__message__text"},"< oh no />"),r.a.createElement("h4",{className:"content__message__text"},"status: ",t),r.a.createElement("h4",{className:"content__message__text"},a.toLowerCase()))},h=a(22),d=a.n(h),_=function(e){var t=e.topics;return r.a.createElement("div",{className:"navbar"},r.a.createElement("nav",null,r.a.createElement("div",{className:"navbar__container"},r.a.createElement(d.a,{trigger:"< topics />",className:"navbar__title"},r.a.createElement("ul",{className:"navbar__list"},t.map((function(e){return r.a.createElement(u.a,{to:"/topics/".concat(e.slug),key:e.slug,className:"link__black"},r.a.createElement("li",{className:"navbar__topic"},"< ",e.slug," />"))})))),r.a.createElement(u.a,{to:"/user/createarticle",className:"link__red"},r.a.createElement("p",null,"create an article =>")))))},f=a(23),E=a.n(f).a.create({baseURL:"https://hm-nc-news-app.herokuapp.com/api/"}),v=function(){return E.get("/topics").then((function(e){return e.data.topics}))},b=function(e,t,a,n,r,c){return E.get("/articles",{params:{topic:e,author:t,sort_by:a,order:n,limit:r,p:c}}).then((function(e){var t=e.data;return{articles:t.articles,total_count:t.total_count}}))},g=function(e){return E.get("/articles/".concat(e)).then((function(e){return e.data.article}))},N=function(e){return E.post("articles",e).then((function(e){return e.data.article}))},C=function(e,t,a){return E.patch("/".concat(e,"s/").concat(t),a).then((function(t){return t.data[e]}))},y=function(e,t){return E.post("/articles/".concat(e,"/comments"),t).then((function(e){return e.data.comment}))},k=function(e,t,a){return E.get("/articles/".concat(e,"/comments"),{params:{limit:t,p:a}}).then((function(e){return e.data.comments}))},j=function(e){return E.delete("/comments/".concat(e))},O=function(e){return E.delete("/articles/".concat(e))},S=function(){return E.get("/users").then((function(e){return e.data.users}))},w=function(e){return E.get("/users/".concat(e)).then((function(e){return e.data.user}))},A=function(){return r.a.createElement("div",{className:"loading"},r.a.createElement("h2",{className:"content__articlelist__title"},"< loading... />"),r.a.createElement("div",{className:"lds-ellipsis"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))},D=function(e){var t=e.handleInputChange;return r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("label",null,"sort by: "),r.a.createElement("select",{className:"content__select",onChange:t},r.a.createElement("option",{value:"newest first"},"newest first"),r.a.createElement("option",{value:"oldest first"},"oldest first"),r.a.createElement("option",{value:"most comments"},"most comments"),r.a.createElement("option",{value:"least comments"},"least comments"),r.a.createElement("option",{value:"most votes"},"most votes"),r.a.createElement("option",{value:"least votes"},"least votes"))))},I=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={articles:[],totalArticles:0,isLoading:!0,sort_by:"created_at",order:"desc",p:1,limit:10,error:null},e.componentDidMount=function(){var t=e.props,a=t.topic,n=t.author,r=e.state,c=r.sort_by,l=r.order,s=r.limit,o=r.p;e.fetchArticles(a,n,c,l,s,o)},e.componentDidUpdate=function(t,a){if(e.props.topic!==t.topic||e.state.p!==a.p){var n=e.props.topic,r=e.state,c=r.sort_by,l=r.order,s=r.limit,o=r.p;e.fetchArticles(n,c,l,s,o)}},e.fetchArticles=function(t,a,n,r,c,l){b(t,a,n,r,c,l).then((function(t){var a=t.articles,n=t.total_count;e.setState({articles:a,isLoading:!1,total_count:n})})).catch((function(t){var a=t.response,n=a.status,r=a.data;e.setState({error:{status:n,msg:r.message},isLoading:!1})}))},e.handleInputChange=function(t){var a={"newest first":{sort_by:"created_at",order:"desc"},"oldest first":{sort_by:"created_at",order:"asc"},"most comments":{sort_by:"comment_count",order:"desc"},"least comments":{sort_by:"comment_count",order:"asc"},"most votes":{sort_by:"votes",order:"desc"},"least votes":{sort_by:"votes",order:"asc"}}[t.target.value],n=a.sort_by,r=a.order;e.setState({sort_by:n,order:r});var c=e.props,l=c.topic,s=c.author,o=e.state,i=o.limit,m=o.p;e.fetchArticles(l,s,n,r,i,m),e.setState({p:1})},e.handleButtonClick=function(t){e.setState((function(e){return{p:e.p+t}}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.articles,n=t.total_count,c=t.isLoading,l=t.sort_by,s=t.order,o=t.limit,i=t.p,m=t.error;if(c)return r.a.createElement(A,null);if(m){var h=this.state.error,d=h.status,_=h.msg;return r.a.createElement(p,{status:d,msg:_})}return r.a.createElement("div",{className:"content__container"},r.a.createElement(D,{sort_by:l,order:s,handleInputChange:this.handleInputChange,handleInputSubmit:this.handleInputSubmit}),r.a.createElement("ul",{className:"content__articlelist"},a.map((function(e){var t=e.title,a=e.votes,n=e.comment_count,c=e.article_id;return r.a.createElement(u.a,{to:"/articles/".concat(c),key:c,className:"link__white"},r.a.createElement("li",{className:"content__article__title"},r.a.createElement("h4",{className:"content__article__title__name"},t),r.a.createElement("p",{className:"content__article__title__stats"},"{ votes: ",a,", comments: ",n," }")))}))),r.a.createElement("section",{className:"content__pages"},r.a.createElement("h4",null,"page ",i),r.a.createElement("button",{onClick:function(){e.handleButtonClick(-1)},disabled:i<2},"\u2190"),r.a.createElement("button",{onClick:function(){e.handleButtonClick(1)},disabled:i*o>=n},"\u2192")))}}]),a}(n.Component),L=function(){return r.a.createElement("div",null,r.a.createElement("h2",{className:"content__articlelist__title"},"< all articles />"),r.a.createElement(I,null))},U=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={users:[]},e.componentDidMount=function(){e.fetchUsers()},e.fetchUsers=function(){S().then((function(t){e.setState({users:t})}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.handleUserChange,n=this.state.users,c=t.username;return r.a.createElement("div",{className:"loggedin"},r.a.createElement("p",null,"{ logged in as: '",c,"' }"),r.a.createElement("label",null,"change user: "),r.a.createElement("select",{className:"content__select",name:"username",onChange:a},r.a.createElement("option",{value:c},c),n.map((function(e){return e.username!==c?r.a.createElement("option",{value:e.username,key:e.username},e.username):null}))))}}]),a}(n.Component),x=function(){return r.a.createElement("div",{className:"header__text"},r.a.createElement(u.a,{className:"link__black",to:"/"},r.a.createElement("h1",null,"< northcoders news />")))},M=function(e){var t=e.topic;return r.a.createElement("div",null,r.a.createElement("h2",{className:"content__articlelist__title"},"< ",t," />"),r.a.createElement(I,{topic:t}))},B=a(24),V=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={comment:{username:"",body:""}},e.handleSubmit=function(t){t.preventDefault();var a=e.state.comment;(0,e.props.addNewComment)(a),e.setState({comment:{username:"",body:""}})},e.handleInputChange=function(t){var a=e.props.user.username,n=t.target.value;e.setState({comment:{username:a,body:n}})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props.user.username,t=this.state.comment.body;return r.a.createElement("div",null,r.a.createElement("h3",null,"< add a comment />"),r.a.createElement("h4",null,"comment = {"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",{className:"content__comments__commentlabel"},r.a.createElement("p",null,"username: "),r.a.createElement("p",{className:"content__comments__commentinput"},e)),r.a.createElement("label",{className:"content__comments__commentlabel"},r.a.createElement("p",null,"comment: "),r.a.createElement("input",{onChange:this.handleInputChange,className:"content__comments__commentinput",value:t})),r.a.createElement("h4",null,"}"),r.a.createElement("button",null,"submit comment")))}}]),a}(n.Component),J=function(e){return new Date(e).toUTCString()},q=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={optimisticVotes:0},e.handleClick=function(t){var a=e.props.id;C("article",a,{inc_votes:t}),e.setState((function(e){return{optimisticVotes:e.optimisticVotes+t}}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.votes,n=t.username,c=t.author,l=this.state.optimisticVotes;return r.a.createElement("div",{className:"content__vote"},r.a.createElement("div",{className:"content__vote__buttons"},r.a.createElement("button",{onClick:function(){e.handleClick(1)},disabled:l>0||n===c},"\u2191"),r.a.createElement("button",{onClick:function(){e.handleClick(-1)},disabled:l<0||n===c},"\u2193")),r.a.createElement("h4",{className:"content__vote__text"},"{ votes: ",a+l," }"))}}]),a}(n.Component),T=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={comments:[],isLoading:!0,optimisticComments:0,limit:10,p:1,error:null},e.componentDidMount=function(){e.fetchComments()},e.componentDidUpdate=function(t,a){e.state.p!==a.p&&e.fetchComments()},e.fetchComments=function(){var t=e.props.article_id,a=e.state,n=a.limit,r=a.p;k(t,n,r).then((function(t){e.setState({comments:t,isLoading:!1})})).catch((function(t){var a=t.response,n=a.status,r=a.data;e.setState({error:{status:n,msg:r.message},isLoading:!1})}))},e.addNewComment=function(t){var a=e.props.article_id;y(a,t).then((function(t){e.setState((function(e){var a=e.comments,n=e.optimisticComments;return{comments:[t].concat(Object(B.a)(a)),optimisticComments:n+1}}))}))},e.handleDeleteClick=function(t){t.preventDefault();var a=t.target.value;j(a).then((function(){e.setState((function(e){var t=e.comments,n=e.optimisticComments,r=Number.parseInt(a);return{comments:t.filter((function(e){return e.comment_id!==r})),optimisticComments:n-1}}))}))},e.handleButtonClick=function(t){e.setState((function(e){return{p:e.p+t}}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.comments,n=t.isLoading,c=t.optimisticComments,l=t.p,s=t.error,o=t.limit,i=this.props.comment_count,m=this.props.user.username;if(n)return r.a.createElement(A,null);if(s){var u=this.state.error,h=u.status,d=u.msg;return r.a.createElement(p,{status:h,msg:d})}return r.a.createElement("div",{className:"content__comments"},r.a.createElement("p",{className:"content__comments__title"},"{ comments: ",+i+c," }"),r.a.createElement("ul",{className:"content__comments__list"},a.map((function(t){var a=t.author,n=t.votes,c=t.created_at,l=t.body,s=t.comment_id;return r.a.createElement("li",{className:"content__comments__list__comment",key:s},r.a.createElement("h3",null,"< ",a," />"),r.a.createElement("h4",null,J(c)),m===a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:e.handleDeleteClick,value:s},"delete comment")):null,r.a.createElement(q,{votes:n,id:s,username:m,author:a}),r.a.createElement("p",null,l))}))),r.a.createElement("section",{className:"content__pages"},r.a.createElement("h4",null,"page ",l),r.a.createElement("button",{onClick:function(){e.handleButtonClick(-1)},disabled:l<2},"\u2190"),r.a.createElement("button",{onClick:function(){e.handleButtonClick(1)},disabled:l*o>=i},"\u2192")),r.a.createElement(V,{user:this.props.user,addNewComment:this.addNewComment}))}}]),a}(n.Component),F=function(e){var t=e.title,a=e.topic;return r.a.createElement("div",{className:"content__container"},r.a.createElement("h2",{className:"content__message__text"},"< your article '",t,"' has been deleted />"),r.a.createElement(u.a,{to:"/topics/".concat(a),className:"link__red"},r.a.createElement("h4",null,"{ return to ",a," articles }")))},H=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={article:{},isLoading:!0,deleted:!1,error:null},e.componentDidMount=function(){var t=e.props.article_id;e.fetchArticle(t)},e.fetchArticle=function(t){g(t).then((function(t){e.setState({article:t,isLoading:!1})})).catch((function(t){var a=t.response,n=a.status,r=a.data;e.setState({error:{status:n,msg:r.message},isLoading:!1})}))},e.handleDeleteClick=function(t){t.preventDefault();var a=t.target.value;O(a),e.setState({deleted:!0})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props.user.username,t=this.state,a=t.article,n=t.isLoading,c=t.deleted,l=t.error,s=a.title,o=a.body,i=a.topic,m=a.author,h=a.votes,d=a.comment_count,_=a.article_id,f=a.created_at;if(c)return r.a.createElement(F,{title:s,topic:i});if(l){var E=this.state.error,v=E.status,b=E.msg;return r.a.createElement(p,{status:v,msg:b})}return n?r.a.createElement(A,null):r.a.createElement("div",{className:"content__container"},r.a.createElement(u.a,{to:"/topics/".concat(i),className:"link__black"},r.a.createElement("h3",null,"< ",i," />")),r.a.createElement("h2",{className:"content__title"},"< ",s," />"),r.a.createElement(u.a,{to:"/users/".concat(m),className:"link__red"},r.a.createElement("h3",null,"< ",m," />")),r.a.createElement("h4",null,J(f)),e===m?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.handleDeleteClick,value:_},"delete article")):null,r.a.createElement(q,{votes:h,id:_,username:e,author:m}),r.a.createElement("p",{className:"content__article__body"},o),r.a.createElement(T,{article_id:_,comment_count:d,user:this.props.user}))}}]),a}(n.Component),G=function(){return r.a.createElement("div",{className:"footer"},r.a.createElement("h4",null,"Created by Harriet Melesi"),r.a.createElement("a",{href:"https://github.com/HMelesi/fe-northcoders-news",target:"_blank",rel:"noopener noreferrer",className:"link__black"},r.a.createElement("h4",null,"See Github project here >")))},R=a(8),z=a(9),K=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={article:{title:"",body:"",topic:"",author:""},postedArticle:{}},e.componentDidMount=function(){var t=e.props.user.username;e.setState((function(e){return{article:Object(z.a)({},e.article,{author:t})}}))},e.handleInputChange=function(t){var a=t.target,n=a.value,r=a.name;e.setState((function(e){return{article:Object(z.a)({},e.article,Object(R.a)({},r,n))}}))},e.handleSubmit=function(t){t.preventDefault();var a=e.state.article;N(a).then((function(t){e.setState((function(e){return{postedArticle:t,article:Object(z.a)({},e.article,{title:"",body:"",topic:""})}}))}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.state.article,t=e.author,a=e.title,n=e.body,c=this.props.topics;return r.a.createElement("div",{className:"content__container"},r.a.createElement("h3",null,"< submit an article />"),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"content__createarticle__form"},r.a.createElement("label",{className:"content__createarticle__label"},r.a.createElement("p",null,"username = "),r.a.createElement("p",{className:"content__createarticle__input"},t)),r.a.createElement("label",{className:"content__createarticle__label"},r.a.createElement("p",null,"title = "),r.a.createElement("input",{onChange:this.handleInputChange,className:"content__createarticle__input",name:"title",value:a,required:!0})),r.a.createElement("label",{className:"content__createarticle__label"},r.a.createElement("p",null,"topic = "),r.a.createElement("select",{className:"content__select",name:"topic",onChange:this.handleInputChange,required:!0,defaultValue:""},r.a.createElement("option",{value:"",disabled:!0},"choose a topic"),c.map((function(e){return r.a.createElement("option",{value:e.slug,key:e.slug},e.slug)})))),r.a.createElement("label",{className:"ccontent__createarticle__label"},r.a.createElement("p",null,"content = "),r.a.createElement("input",{onChange:this.handleInputChange,className:"content__createarticle__input",name:"body",value:n,required:!0})),r.a.createElement("button",null,"post article =>")),this.state.postedArticle.article_id?r.a.createElement(u.a,{to:"/articles/".concat(this.state.postedArticle.article_id),className:"link__red"},r.a.createElement("h4",null,"view your article '",this.state.postedArticle.title,"' here")):null)}}]),a}(n.Component),P=function(e){var t=e.author;return r.a.createElement("div",null,r.a.createElement("h2",{className:"content__articlelist__title"},"< all articles by ",t," />"),r.a.createElement(I,{author:t}))},Q=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={user:{username:"jessjelly",avatar_url:"https://s-media-cache-ak0.pinimg.com/564x/39/62/ec/3962eca164e60cf46f979c1f57d4078b.jpg",name:"Jess Jelly"},topics:[]},e.componentDidMount=function(){e.fetchTopics()},e.handleUserChange=function(t){var a=t.target.value;w(a).then((function(t){e.setState({user:t})}))},e.fetchTopics=function(){v().then((function(t){e.setState({topics:t})}))},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"header"},r.a.createElement(x,null),r.a.createElement(U,{user:this.state.user,handleUserChange:this.handleUserChange,handleUserSubmit:this.handleUserSubmit})),r.a.createElement(_,{topics:this.state.topics}),r.a.createElement(u.b,{className:"content"},r.a.createElement(L,{path:"/",user:this.state.user}),r.a.createElement(M,{path:"/topics/:topic"}),r.a.createElement(P,{path:"/users/:author"}),r.a.createElement(H,{path:"/articles/:article_id",user:this.state.user}),r.a.createElement(K,{path:"/user/createarticle",user:this.state.user,topics:this.state.topics}),r.a.createElement(p,{default:!0,status:404,msg:"the page you are looking for does not seem to exist"})),r.a.createElement("footer",null,r.a.createElement(G,null)))}}]),a}(n.Component);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Q,null)),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.f88f6053.chunk.js.map