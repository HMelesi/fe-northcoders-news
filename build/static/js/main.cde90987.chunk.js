(this["webpackJsonpnorthcoders-news"]=this["webpackJsonpnorthcoders-news"]||[]).push([[0],{25:function(e,t,a){e.exports=a(55)},30:function(e,t,a){},31:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),l=a.n(c),s=(a(30),a(2)),o=a(3),i=a(5),m=a(4),u=(a(31),a(1)),_=function(e){var t=e.status,a=e.msg;return r.a.createElement("div",{className:"content__container"},r.a.createElement("h2",{className:"content__message__text"},"< oh no />"),r.a.createElement("h4",{className:"content__message__text"},"status: ",t),r.a.createElement("h4",{className:"content__message__text"},a.toLowerCase()))},d=a(22),p=a.n(d),h=function(e){var t=e.topics;return r.a.createElement("div",{className:"navbar"},r.a.createElement("nav",{className:"navbar__container"},r.a.createElement(p.a,{trigger:"topics +",className:"navbar__title"},r.a.createElement("ul",{className:"navbar__list"},t.map((function(e){return r.a.createElement("li",{className:"navbar__topic",key:e.slug},r.a.createElement(u.a,{to:"/topics/".concat(e.slug),className:"link__black"},"< ",e.slug," />"))}))))))},f=a(23),E=a.n(f).a.create({baseURL:"https://hm-nc-news-app.herokuapp.com/api/"}),v=function(){return E.get("/topics").then((function(e){return e.data.topics}))},b=function(e,t,a,n,r,c){return E.get("/articles",{params:{topic:e,author:t,sort_by:a,order:n,limit:r,p:c}}).then((function(e){var t=e.data;return{articles:t.articles,total_count:t.total_count}}))},g=function(e){return E.get("/articles/".concat(e)).then((function(e){return e.data.article}))},N=function(e){return E.post("articles",e).then((function(e){return e.data.article}))},y=function(e,t,a){return E.patch("/".concat(e,"s/").concat(t),a).then((function(t){return t.data[e]}))},C=function(e,t){return E.post("/articles/".concat(e,"/comments"),t).then((function(e){return e.data.comment}))},k=function(e,t,a){return E.get("/articles/".concat(e,"/comments"),{params:{limit:t,p:a}}).then((function(e){return e.data.comments}))},j=function(e){return E.delete("/comments/".concat(e))},S=function(e){return E.delete("/articles/".concat(e))},O=function(){return E.get("/users").then((function(e){return e.data.users}))},w=function(e){return E.get("/users/".concat(e)).then((function(e){return e.data.user}))},A=function(){return r.a.createElement("div",{className:"loading"},r.a.createElement("h2",{className:"content__articlelist__title"},"< loading... />"),r.a.createElement("div",{className:"lds-ellipsis"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))},D=function(e){var t=e.handleInputChange;return r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("label",null,"sort by:",r.a.createElement("select",{className:"content__select",onChange:t},r.a.createElement("option",{value:"newest first"},"newest first"),r.a.createElement("option",{value:"oldest first"},"oldest first"),r.a.createElement("option",{value:"most comments"},"most comments"),r.a.createElement("option",{value:"least comments"},"least comments"),r.a.createElement("option",{value:"most votes"},"most votes"),r.a.createElement("option",{value:"least votes"},"least votes")))))},I=function(e){var t=e.article_id,a=e.title,n=e.comment_count,c=e.votes;return r.a.createElement("li",{className:"content__article__title"},r.a.createElement(u.a,{to:"/articles/".concat(t),className:"link__white"},r.a.createElement("h4",{className:"content__article__title__name"},a),r.a.createElement("p",{className:"content__article__title__stats"},"{ votes: ",c,", comments: ",n," }")))},L=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={articles:[],totalArticles:0,isLoading:!0,sort_by:"created_at",order:"desc",p:1,limit:10,error:null},e.componentDidMount=function(){var t=e.props,a=t.topic,n=t.author,r=e.state,c=r.sort_by,l=r.order,s=r.limit,o=r.p;e.fetchArticles(a,n,c,l,s,o)},e.componentDidUpdate=function(t,a){if(e.props.topic!==t.topic){var n=e.props,r=n.topic,c=n.author,l=e.state,s=l.sort_by,o=l.order,i=l.limit;e.setState({p:1}),e.fetchArticles(r,c,s,o,i,1)}else if(e.state.p!==a.p||e.state.sort_by!==a.sort_by){var m=e.props,u=m.topic,_=m.author,d=e.state,p=d.sort_by,h=d.order,f=d.limit,E=d.p;e.fetchArticles(u,_,p,h,f,E)}},e.fetchArticles=function(t,a,n,r,c,l){b(t,a,n,r,c,l).then((function(t){var a=t.articles,n=t.total_count;e.setState({articles:a,isLoading:!1,total_count:n})})).catch((function(t){var a=t.response,n=a.status,r=a.data;e.setState({error:{status:n,msg:r.message},isLoading:!1})}))},e.handleInputChange=function(t){var a={"newest first":{sort_by:"created_at",order:"desc"},"oldest first":{sort_by:"created_at",order:"asc"},"most comments":{sort_by:"comment_count",order:"desc"},"least comments":{sort_by:"comment_count",order:"asc"},"most votes":{sort_by:"votes",order:"desc"},"least votes":{sort_by:"votes",order:"asc"}}[t.target.value],n=a.sort_by,r=a.order;e.setState({sort_by:n,order:r,p:1})},e.handleButtonClick=function(t){e.setState((function(e){return{p:e.p+t}}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.articles,n=t.total_count,c=t.isLoading,l=t.sort_by,s=t.order,o=t.limit,i=t.p,m=t.error;if(c)return r.a.createElement(A,null);if(m){var u=this.state.error,d=u.status,p=u.msg;return r.a.createElement(_,{status:d,msg:p})}return r.a.createElement("div",{className:"content__container"},r.a.createElement("section",{className:"content__title__section"},r.a.createElement(D,{sort_by:l,order:s,handleInputChange:this.handleInputChange,handleInputSubmit:this.handleInputSubmit})),r.a.createElement("ul",{className:"content__articlelist"},a.map((function(e){var t=e.title,a=e.votes,n=e.comment_count,c=e.article_id;return r.a.createElement(I,{article_id:c,comment_count:n,title:t,votes:a,key:c})}))),r.a.createElement("section",{className:"content__pages"},r.a.createElement("h4",null,"page ",i),r.a.createElement("button",{onClick:function(){e.handleButtonClick(-1)},disabled:i<2},"\u2190"),r.a.createElement("button",{onClick:function(){e.handleButtonClick(1)},disabled:i*o>=n},"\u2192")))}}]),a}(n.Component),U=function(){return r.a.createElement("div",null,r.a.createElement("h2",{className:"content__articlelist__title"},"< all articles />"),r.a.createElement(L,null))},x=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={users:[]},e.componentDidMount=function(){e.fetchUsers()},e.fetchUsers=function(){O().then((function(t){e.setState({users:t})}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.handleUserChange,n=this.state.users,c=t.username;return r.a.createElement("div",{className:"loggedin"},r.a.createElement("p",null,"{ logged in as: '",c,"' }"),r.a.createElement("label",null,"change user:",r.a.createElement("select",{className:"content__select",name:"username",onChange:a},r.a.createElement("option",{value:c},c),n.map((function(e){return e.username!==c?r.a.createElement("option",{value:e.username,key:e.username},e.username):null})))),r.a.createElement(u.a,{to:"/user/createarticle"},r.a.createElement("button",{className:"button__link__red"},"write an article")))}}]),a}(n.Component),M=function(){return r.a.createElement("div",{className:"header__text"},r.a.createElement(u.a,{className:"link__black",to:"/"},r.a.createElement("h1",null,"< northcoders news />")))},B=function(e){var t=e.topic;return r.a.createElement("div",null,r.a.createElement("h2",{className:"content__articlelist__title"},"< ",t," />"),r.a.createElement(L,{topic:t}))},F=a(24),J=a(8),V=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={comment:{username:"",body:""}},e.handleSubmit=function(t){t.preventDefault();var a=e.state.comment;(0,e.props.addNewComment)(a),e.setState({comment:{username:"",body:""}})},e.handleInputChange=function(t){var a=e.props.user.username,n=t.target.value;e.setState({comment:{username:a,body:n}})},e.resetForm=function(){e.setState((function(e){return{comment:Object(J.a)({},e.comment,{body:""})}}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props.user.username,t=this.state.comment.body;return r.a.createElement("div",{className:"content__container"},r.a.createElement("h3",null,"< add a comment />"),r.a.createElement("div",{className:"content__form"},r.a.createElement("form",{onSubmit:this.handleSubmit,id:"comment_form"},r.a.createElement("label",{className:"content__form__label"},r.a.createElement("p",null,"username: "),r.a.createElement("p",{className:"content__form__input"},e)),r.a.createElement("label",{className:"content__form__label"},r.a.createElement("p",null,"comment: "),r.a.createElement("textarea",{name:"body",form:"comment_form",onChange:this.handleInputChange,value:t,required:!0,className:"content__form__input",rows:"15"})),r.a.createElement("div",{className:"form__buttons"},r.a.createElement("button",{type:"submit",className:"button__link__red"},"submit comment"),r.a.createElement("button",{onClick:this.resetForm,type:"reset",className:"button__link__red"},"clear fields")))))}}]),a}(n.Component),q=function(e){return new Date(e).toUTCString()},T=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={optimisticVotes:0},e.handleClick=function(t){var a=e.props,n=a.id,r=a.type;y(r,n,{inc_votes:t}),e.setState((function(e){return{optimisticVotes:e.optimisticVotes+t}}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.votes,n=t.username,c=t.author,l=this.state.optimisticVotes;return r.a.createElement("div",{className:"content__vote"},r.a.createElement("div",{className:"content__vote__buttons"},r.a.createElement("button",{onClick:function(){e.handleClick(1)},disabled:l>0||n===c},"\u2191"),r.a.createElement("button",{onClick:function(){e.handleClick(-1)},disabled:l<0||n===c},"\u2193")),r.a.createElement("h4",{className:"content__vote__text"},"{ votes: ",a+l," }"))}}]),a}(n.Component),H=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={comments:[],isLoading:!0,optimisticComments:0,limit:10,p:1,error:null},e.componentDidMount=function(){e.fetchComments()},e.componentDidUpdate=function(t,a){e.state.p!==a.p&&e.fetchComments()},e.fetchComments=function(){var t=e.props.article_id,a=e.state,n=a.limit,r=a.p;k(t,n,r).then((function(t){e.setState({comments:t,isLoading:!1})})).catch((function(t){var a=t.response,n=a.status,r=a.data;e.setState({error:{status:n,msg:r.message},isLoading:!1})}))},e.addNewComment=function(t){var a=e.props.article_id;C(a,t).then((function(t){e.setState((function(e){var a=e.comments,n=e.optimisticComments;return{comments:[t].concat(Object(F.a)(a)),optimisticComments:n+1}}))}))},e.handleDeleteClick=function(t){t.preventDefault();var a=t.target.value;j(a).then((function(){e.setState((function(e){var t=e.comments,n=e.optimisticComments,r=Number.parseInt(a);return{comments:t.filter((function(e){return e.comment_id!==r})),optimisticComments:n-1}}))}))},e.handleButtonClick=function(t){e.setState((function(e){return{p:e.p+t}}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.comments,n=t.isLoading,c=t.optimisticComments,l=t.p,s=t.error,o=t.limit,i=this.props.comment_count,m=this.props.user.username;if(n)return r.a.createElement(A,null);if(s){var u=this.state.error,d=u.status,p=u.msg;return r.a.createElement(_,{status:d,msg:p})}return r.a.createElement("div",{className:"content__comments"},r.a.createElement("p",{className:"content__comments__title"},"{ comments: ",+i+c," }"),r.a.createElement("a",{href:"#addcomment"},r.a.createElement("button",{className:"button__link__red"},"add comment")),r.a.createElement("ul",{className:"content__comments__list"},a.map((function(t){var a=t.author,n=t.votes,c=t.created_at,l=t.body,s=t.comment_id;return r.a.createElement("li",{className:"content__comments__list__comment",key:s},r.a.createElement("h3",null,"< ",a," />"),r.a.createElement("h4",null,q(c)),m===a?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:e.handleDeleteClick,value:s},"delete comment")):null,r.a.createElement(T,{votes:n,id:s,username:m,author:a,type:"comment"}),r.a.createElement("p",null,l))}))),r.a.createElement("section",{className:"content__pages"},r.a.createElement("h4",null,"page ",l),r.a.createElement("button",{onClick:function(){e.handleButtonClick(-1)},disabled:l<2},"\u2190"),r.a.createElement("button",{onClick:function(){e.handleButtonClick(1)},disabled:l*o>=i},"\u2192")),r.a.createElement("section",{id:"addcomment"},r.a.createElement(V,{user:this.props.user,addNewComment:this.addNewComment})))}}]),a}(n.Component),G=function(e){var t=e.title,a=e.topic;return r.a.createElement("div",{className:"content__container"},r.a.createElement("h2",{className:"content__message__text"},"< your article '",t,"' has been deleted />"),r.a.createElement(u.a,{to:"/topics/".concat(a),className:"link__red"},r.a.createElement("h4",null,"{ return to ",a," articles }")))},R=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={article:{},isLoading:!0,deleted:!1,error:null},e.componentDidMount=function(){var t=e.props.article_id;e.fetchArticle(t)},e.fetchArticle=function(t){g(t).then((function(t){e.setState({article:t,isLoading:!1})})).catch((function(t){var a=t.response,n=a.status,r=a.data;e.setState({error:{status:n,msg:r.message},isLoading:!1})}))},e.handleDeleteClick=function(t){t.preventDefault();var a=t.target.value;S(a),e.setState({deleted:!0})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props.user.username,t=this.state,a=t.article,n=t.isLoading,c=t.deleted,l=t.error,s=a.title,o=a.body,i=a.topic,m=a.author,d=a.votes,p=a.comment_count,h=a.article_id,f=a.created_at;if(c)return r.a.createElement(G,{title:s,topic:i});if(l){var E=this.state.error,v=E.status,b=E.msg;return r.a.createElement(_,{status:v,msg:b})}return n?r.a.createElement(A,null):r.a.createElement("div",{className:"content__container"},r.a.createElement(u.a,{to:"/topics/".concat(i),className:"link__black"},r.a.createElement("h3",null,"< ",i," />")),r.a.createElement("h2",{className:"content__title"},"< ",s," />"),r.a.createElement(u.a,{to:"/users/".concat(m),className:"link__red"},r.a.createElement("h3",null,m)),r.a.createElement("h4",null,q(f)),e===m?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.handleDeleteClick,value:h},"delete article")):null,r.a.createElement(T,{votes:d,id:h,username:e,author:m,type:"article"}),r.a.createElement("p",{className:"content__article__body"},o),r.a.createElement(H,{article_id:h,comment_count:p,user:this.props.user}))}}]),a}(n.Component),z=function(){return r.a.createElement("div",{className:"footer"},r.a.createElement("h4",null,"Created by Harriet Melesi"),r.a.createElement("a",{href:"https://github.com/HMelesi/fe-northcoders-news",target:"_blank",rel:"noopener noreferrer",className:"link__black"},r.a.createElement("h4",null,"See Github project here >")))},K=a(9),P=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={article:{title:"",body:"",topic:""},postedArticle:{}},e.handleInputChange=function(t){var a=t.target,n=a.value,r=a.name;e.setState((function(e){return{article:Object(J.a)({},e.article,Object(K.a)({},r,n))}}))},e.handleSubmit=function(t){t.preventDefault();var a=e.props.user,n=Object(J.a)({},e.state.article,{author:a.username});N(n).then((function(t){e.setState({postedArticle:t,article:{title:"",body:"",topic:""}})}))},e.resetForm=function(){e.setState((function(e){return{article:Object(J.a)({},e.article,{title:"",body:"",topic:""})}}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.state.article,t=e.title,a=e.body,n=this.props,c=n.topics,l=n.user;return r.a.createElement("div",{className:"content__container"},r.a.createElement("h3",null,"< submit an article />"),r.a.createElement("div",{className:"content__form"},r.a.createElement("form",{onSubmit:this.handleSubmit,id:"article_form"},r.a.createElement("label",{className:"content__form__label"},r.a.createElement("p",null,"username: "),r.a.createElement("p",{className:"content__form__input"},l.username)),r.a.createElement("label",{className:"content__form__label"},r.a.createElement("p",null,"title: "),r.a.createElement("input",{onChange:this.handleInputChange,className:"content__form__input",name:"title",value:t,required:!0})),r.a.createElement("label",{className:"content__form__label"},r.a.createElement("p",null,"topic: "),r.a.createElement("select",{className:"content__select",name:"topic",onChange:this.handleInputChange,required:!0,defaultValue:""},r.a.createElement("option",{value:"",disabled:!0},"choose a topic"),c.map((function(e){return r.a.createElement("option",{value:e.slug,key:e.slug},e.slug)})))),r.a.createElement("div",{className:"content__createarticle__form__large"},r.a.createElement("label",{className:"content__form__label"},r.a.createElement("p",null,"content: "),r.a.createElement("textarea",{name:"body",form:"article_form",onChange:this.handleInputChange,value:a,required:!0,className:"content__form__input",rows:"15"}))),r.a.createElement("div",{className:"form__buttons"},r.a.createElement("button",{type:"submit",className:"button__link__red"},"post article"),r.a.createElement("button",{onClick:this.resetForm,type:"reset",className:"button__link__red"},"clear fields")))),this.state.postedArticle.article_id?r.a.createElement(u.a,{to:"/articles/".concat(this.state.postedArticle.article_id),className:"link__red"},r.a.createElement("h4",null,"view your article '",this.state.postedArticle.title,"' here")):null)}}]),a}(n.Component),Q=function(e){var t=e.author;return r.a.createElement("div",null,r.a.createElement("h2",{className:"content__articlelist__title"},"< all articles by ",t," />"),r.a.createElement(L,{author:t}))},W=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={user:{username:"jessjelly",avatar_url:"https://s-media-cache-ak0.pinimg.com/564x/39/62/ec/3962eca164e60cf46f979c1f57d4078b.jpg",name:"Jess Jelly"},topics:[]},e.componentDidMount=function(){e.fetchTopics(),void 0!==localStorage.user&&e.setState({user:JSON.parse(localStorage.user)})},e.handleUserChange=function(t){var a=t.target.value;w(a).then((function(t){e.setState({user:t}),window.localStorage.setItem("user",JSON.stringify(t))}))},e.fetchTopics=function(){v().then((function(t){e.setState({topics:t})}))},e}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"header"},r.a.createElement(M,null),r.a.createElement(x,{user:this.state.user,handleUserChange:this.handleUserChange,handleUserSubmit:this.handleUserSubmit})),r.a.createElement(h,{topics:this.state.topics}),r.a.createElement(u.b,{className:"content"},r.a.createElement(U,{path:"/"}),r.a.createElement(B,{path:"/topics/:topic"}),r.a.createElement(Q,{path:"/users/:author"}),r.a.createElement(R,{path:"/articles/:article_id",user:this.state.user}),r.a.createElement(P,{path:"/user/createarticle",user:this.state.user,topics:this.state.topics}),r.a.createElement(_,{default:!0,status:404,msg:"the page you are looking for does not seem to exist"})),r.a.createElement("footer",null,r.a.createElement(z,null)))}}]),a}(n.Component);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(W,null)),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.cde90987.chunk.js.map